From 1269fe8b3813c7b7d5552a2b88bc2e7bd4d0c1f9 Mon Sep 17 00:00:00 2001
From: mlitn <matthias@mullie.eu>
Date: Tue, 28 Feb 2012 18:35:43 +0100
Subject: [PATCH] fix xss vulnerability

---
 backend/modules/error/actions/index.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/backend/modules/error/actions/index.php b/backend/modules/error/actions/index.php
index 18726512c9..e491a305cb 100644
--- a/backend/modules/error/actions/index.php
+++ b/backend/modules/error/actions/index.php
@@ -64,7 +64,7 @@ protected function parse()
 				SpoonHTTP::setHeadersByCode(404);
 
 				// give a nice error, so we can detect which file is missing
-				echo 'Requested file (' . implode('?', $chunks) . ') not found.';
+				echo 'Requested file (' . htmlspecialchars($this->getParameter('querystring')) . ') not found.';
 
 				// stop script execution
 				exit;
